"use strict";(()=>{var a=new Array(10).fill(null),d=null;function f(){let e=location.protocol==="https:"?"wss:":"ws:";d=new WebSocket(`${e}//${location.host}`),d.onopen=()=>{console.log("WebSocket connected")},d.onmessage=t=>{let n=JSON.parse(t.data);if(n.type==="counter"){g(n.count);return}n.type==="comment"&&S(n.userName,n.text,n.userColor,n.emojis??{})},d.onclose=()=>{console.log("WebSocket disconnected"),h()},d.onerror=t=>{console.error("WebSocket error:",t),d?.close()}}function p(e){return e>=100?"#FFD700":e>=50?"#FF9800":e>=25?"#FFEB3B":"#4CAF50"}function g(e){let t=document.getElementById("comment-counter");t&&(t.style.display="block",t.textContent=`\u{1F4AC} ${e}`,t.style.color=p(e))}function h(){let e=document.getElementById("comment-counter");e&&(e.style.display="none")}function N(e){let t=e.length;return t<=10?40:t<=30?32:24}function E(e,t){let n=document.createDocumentFragment();if(!t||Object.keys(t).length===0)return n.appendChild(document.createTextNode(e)),n;let i=/:([a-z0-9_+\-\u3000-\u9fff\u30a0-\u30ff\u3040-\u309f\uff00-\uffef]+):/gi,o=0,r;for(;(r=i.exec(e))!==null;){r.index>o&&n.appendChild(document.createTextNode(e.slice(o,r.index)));let s=r[1]?.toLowerCase(),l=s?t[s]:void 0;if(l){if(!l.startsWith("https://")&&!l.startsWith("http://")){n.appendChild(document.createTextNode(r[0])),o=r.index+r[0].length;continue}let c=document.createElement("img");c.src=l,c.alt=":"+s+":",c.className="emoji",c.onerror=function(){let u=document.createTextNode(":"+s+":");this.parentNode?.replaceChild(u,this)},n.appendChild(c)}else n.appendChild(document.createTextNode(r[0]));o=r.index+r[0].length}return o<e.length&&n.appendChild(document.createTextNode(e.slice(o))),n}function b(e){let n=window.innerHeight*.8/10;return window.innerHeight*.1+n*(e+.5)}function C(){let e=[];for(let t=0;t<a.length;t++)a[t]===null&&e.push(t);return e}function x(){let e=0,t=1/0;for(let n=0;n<a.length;n++){let i=a[n];i!=null&&i<t&&(t=i,e=n)}return e}function A(){let e=C();if(e.length>0){let t=Math.floor(Math.random()*e.length);return e[t]}return x()}function S(e,t,n,i){let o=document.createElement("div");o.className="comment",o.style.color=n;let r=N(t);o.style.fontSize=`${r}px`;let s=document.createElement("span");s.className="comment-text",s.appendChild(E(t,i)),o.appendChild(s);let l=document.createElement("span");l.className="user-name",l.textContent=e,o.appendChild(l);let c=A(),u=b(c);o.style.top=`${u}px`;let m=Date.now();a[c]=m,setTimeout(()=>{a[c]===m&&(a[c]=null)},8/2*1e3),document.body.appendChild(o),o.addEventListener("animationend",()=>{o.remove()})}f();})();
//# sourceMappingURL=app.js.map
